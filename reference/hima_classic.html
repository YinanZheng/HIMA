<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Classic high-dimensional mediation analysis — hima_classic • HIMA</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classic high-dimensional mediation analysis — hima_classic"><meta name="description" content="hima_classic is used to estimate and test classic high-dimensional mediation effects (linear &amp;amp; logistic regression)."><meta property="og:description" content="hima_classic is used to estimate and test classic high-dimensional mediation effects (linear &amp;amp; logistic regression)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HIMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hima-vignette.html">Tutorials</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/YinanZheng/HIMA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Classic high-dimensional mediation analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/YinanZheng/HIMA/blob/HEAD/R/hima_classic.R"><code>R/hima_classic.R</code></a></small>
      <div class="d-none name"><code>hima_classic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hima_classic</code> is used to estimate and test classic high-dimensional mediation effects (linear &amp; logistic regression).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hima_classic</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">M</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  COV.XM <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  COV.MY <span class="op">=</span> <span class="va">COV.XM</span>,</span>
<span>  Y.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continuous"</span>, <span class="st">"binary"</span><span class="op">)</span>,</span>
<span>  M.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"negbin"</span><span class="op">)</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCP"</span>, <span class="st">"SCAD"</span>, <span class="st">"lasso"</span><span class="op">)</span>,</span>
<span>  topN <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncore <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Bonfcut <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector of exposure. Do not use <code>data.frame</code> or <code>matrix</code>.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>a <code>data.frame</code> or <code>matrix</code> of high-dimensional mediators. Rows represent samples, columns
represent variables.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a vector of outcome. Can be either continuous or binary (0-1). Do not use <code>data.frame</code> or <code>matrix</code>.</p></dd>


<dt id="arg-cov-xm">COV.XM<a class="anchor" aria-label="anchor" href="#arg-cov-xm"></a></dt>
<dd><p>a <code>data.frame</code> or <code>matrix</code> of covariates dataset for testing the association <code>M ~ X</code>.
Covariates specified here will not participate penalization. Default = <code>NULL</code>. If the covariates
contain mixed data types, please make sure all categorical variables are properly formatted as <code>factor</code> type.</p></dd>


<dt id="arg-cov-my">COV.MY<a class="anchor" aria-label="anchor" href="#arg-cov-my"></a></dt>
<dd><p>a <code>data.frame</code> or <code>matrix</code> of covariates dataset for testing the association <code>Y ~ M</code>.
Covariates specified here will not participate penalization. If not specified, the same set of covariates for
<code>M ~ X</code> will be applied (i.e., <code>COV.XM</code>. Using different sets of covariates is allowed but this needs to be
handled carefully.</p></dd>


<dt id="arg-y-type">Y.type<a class="anchor" aria-label="anchor" href="#arg-y-type"></a></dt>
<dd><p>data type of outcome (<code>Y</code>). Either <code>'continuous'</code> (default) or <code>'binary'</code>.</p></dd>


<dt id="arg-m-type">M.type<a class="anchor" aria-label="anchor" href="#arg-m-type"></a></dt>
<dd><p>data type of mediator (<code>M</code>). Either <code>'gaussian'</code> (default) or <code>'negbin'</code> (i.e., negative binomial).</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>the penalty to be applied to the model. Either <code>'MCP'</code> (the default), <code>'SCAD'</code>, or
<code>'lasso'</code>.</p></dd>


<dt id="arg-topn">topN<a class="anchor" aria-label="anchor" href="#arg-topn"></a></dt>
<dd><p>an integer specifying the number of top markers from sure independent screening.
Default = <code>NULL</code>. If <code>NULL</code>, <code>topN</code> will be either <code>ceiling(n/log(n))</code> for continuous outcome,
or <code>ceiling(n/(2*log(n)))</code> for binary outcome, where <code>n</code> is the sample size. If the sample size is greater
than topN (pre-specified or calculated), all mediators will be included in the test (i.e. low-dimensional scenario).</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Enable parallel computing feature? Default = <code>FALSE</code>.</p></dd>


<dt id="arg-ncore">ncore<a class="anchor" aria-label="anchor" href="#arg-ncore"></a></dt>
<dd><p>number of cores to run parallel computing Valid when <code>parallel = TRUE</code>.
By default max number of cores available in the machine will be utilized.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>logical. Should the function scale the data? Default = <code>TRUE</code>.</p></dd>


<dt id="arg-bonfcut">Bonfcut<a class="anchor" aria-label="anchor" href="#arg-bonfcut"></a></dt>
<dd><p>Bonferroni-corrected p value cutoff applied to select significant mediators. Default = <code>0.05</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical. Should the function be verbose? Default = <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments passed to <code>ncvreg</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame containing mediation testing results of selected mediators.</p><dl><dt>Index: </dt>
<dd><p>mediation name of selected significant mediator.</p></dd>

    <dt>alpha_hat: </dt>
<dd><p>coefficient estimates of exposure (X) –&gt; mediators (M) (adjusted for covariates).</p></dd>

    <dt>beta_hat: </dt>
<dd><p>coefficient estimates of mediators (M) –&gt; outcome (Y) (adjusted for covariates and exposure).</p></dd>

    <dt>IDE: </dt>
<dd><p>mediation (indirect) effect, i.e., alpha*beta.</p></dd>

    <dt>rimp: </dt>
<dd><p>relative importance of the mediator.</p></dd>

    <dt>pmax: </dt>
<dd><p>joint raw p-value of selected significant mediator (based on Bonferroni method).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Zhang H, Zheng Y, Zhang Z, Gao T, Joyce B, Yoon G, Zhang W, Schwartz J, Just A, Colicino E, Vokonas P, Zhao L,
Lv J, Baccarelli A, Hou L, Liu L. Estimating and Testing High-dimensional Mediation Effects in Epigenetic Studies.
Bioinformatics. 2016. DOI: 10.1093/bioinformatics/btw351. PMID: 27357171; PMCID: PMC5048064</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Note: In the following examples, M1, M2, and M3 are true mediators.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When Y is continuous and normally distributed</span></span></span>
<span class="r-in"><span><span class="co"># Example 1 (continuous outcome):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ContinuousOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hima.fit</span> <span class="op">&lt;-</span> <span class="fu">hima_classic</span><span class="op">(</span></span></span>
<span class="r-in"><span>  X <span class="op">=</span> <span class="va">ContinuousOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">$</span><span class="va">Treatment</span>,</span></span>
<span class="r-in"><span>  Y <span class="op">=</span> <span class="va">ContinuousOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">$</span><span class="va">Outcome</span>,</span></span>
<span class="r-in"><span>  M <span class="op">=</span> <span class="va">ContinuousOutcome</span><span class="op">$</span><span class="va">Mediator</span>,</span></span>
<span class="r-in"><span>  COV.XM <span class="op">=</span> <span class="va">ContinuousOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  Y.type <span class="op">=</span> <span class="st">"continuous"</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Disabled only for simulation data</span></span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hima.fit</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When Y is binary</span></span></span>
<span class="r-in"><span><span class="co"># Example 2 (binary outcome):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BinaryOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hima.logistic.fit</span> <span class="op">&lt;-</span> <span class="fu">hima_classic</span><span class="op">(</span></span></span>
<span class="r-in"><span>  X <span class="op">=</span> <span class="va">BinaryOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">$</span><span class="va">Treatment</span>,</span></span>
<span class="r-in"><span>  Y <span class="op">=</span> <span class="va">BinaryOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">$</span><span class="va">Disease</span>,</span></span>
<span class="r-in"><span>  M <span class="op">=</span> <span class="va">BinaryOutcome</span><span class="op">$</span><span class="va">Mediator</span>,</span></span>
<span class="r-in"><span>  COV.XM <span class="op">=</span> <span class="va">BinaryOutcome</span><span class="op">$</span><span class="va">PhenoData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  Y.type <span class="op">=</span> <span class="st">"binary"</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Disabled only for simulation data</span></span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hima.logistic.fit</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yinan Zheng, Haixiang Zhang, Lifang Hou, Lei Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

